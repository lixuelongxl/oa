<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.core136.mapper.bpm.BpmSealSignMapper">
<resultMap id="BpmSealSign" type="com.core136.bean.bpm.BpmSealSign" >
    <id column="ID" property="id" jdbcType="BIGINT" />
    <result column="SEAL_SING_ID" property="sealSignId" jdbcType="VARCHAR" />
    <result column="TITLE" property="title" jdbcType="VARCHAR" />
    <result column="SORT_NO" property="sortNo" jdbcType="INTEGER" />
    <result column="PASSWORD" property="password" jdbcType="VARCHAR" />
    <result column="ACCOUNT_ID" property="accountId" jdbcType="VARCHAR" />
    <result column="SEAL_SIGN_BYTE" property="sealSignByte" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="VARCHAR" />
    <result column="CREATE_USER" property="createUser" jdbcType="VARCHAR" />
    <result column="ORG_ID" property="orgId" jdbcType="VARCHAR" />
  </resultMap>

<select id="getAllBpmSealSignList" resultType="java.util.HashMap">
        SELECT B.ID AS id,B.SEAL_SIGN_ID AS sealSignId,B.TITLE AS title,B.ACCOUNT_ID AS accountId,
        (SELECT U.USER_NAME FROM USER_INFO U WHERE U.ORG_ID=B.ORG_ID AND U.ACCOUNT_ID=B.ACCOUNT_ID) AS usedUserName,
        CREATE_TIME AS createTime,CREATE_USER AS createUser,
        (SELECT U.USER_NAME FROM USER_INFO U WHERE U.ORG_ID=B.ORG_ID AND U.ACCOUNT_ID=B.CREATE_USER) AS createUserName
        FROM BPM_SEAL_SIGN B WHERE B.ORG_ID=#{orgId}
        <if test="search !='%%' and search !=''.toString() and search!=null">
        	AND B.TITLE LIKE #{search} OR 
        	B.ACCOUNT_ID IN(SELECT TEMP.ACCOUNT_ID FROM USER_INFO TEMP 
        	WHERE TEMP.ORG_ID=#{orgId} AND (TEMP.ACCOUNT_ID LIKE #{search} OR TEMP.USER_NAME LIKE #{search}))
        </if>
</select>


</mapper>