<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.core136.mapper.sys.MobileSmsMapper">
	<resultMap id="MobileSms" type="com.core136.bean.sys.MobileSms">
		<id column="ID" property="id" jdbcType="BIGINT" />
		<result column="SMS_ID" property="smsId" jdbcType="VARCHAR" />
		<result column="FROM_ID" property="fromId" jdbcType="VARCHAR" />
		<result column="TO_ID" property="toId" jdbcType="VARCHAR" />
		<result column="IPHONE" property="iphone" jdbcType="VARCHAR" />
		<result column="CONTEXT" property="context" jdbcType="VARCHAR" />
		<result column="SEND_TIME" property="sendTime" jdbcType="VARCHAR" />
		<result column="MODULE" property="module" jdbcType="VARCHAR" />
		<result column="STATUS" property="status" jdbcType="VARCHAR" />
		<result column="CREATE_USER" property="createUser" jdbcType="VARCHAR" />
		<result column="CREATE_TIME" property="createTime" jdbcType="VARCHAR" />
		<result column="ORG_ID" property="orgId" jdbcType="VARCHAR" />
	</resultMap>
	<select id="getMySendMoblieSms" resultType="java.util.HashMap">
		SELECT SMS_ID AS smsId,FROM_ID AS fromId,TO_ID AS toId,IPHONE AS iphone, 
		(SELECT U.USER_NAME FROM USER_INFO U WHERE U.ORG_ID=#{orgId} AND U.ACCOUNT_ID=TO_ID) AS toUserName,
		CONTEXT AS context,
		SEND_TIME AS sendTime,MODULE AS module,STATUS AS status,CREATE_USER AS
		createUser
		FROM MOBILE_SMS
		WHERE ORG_ID=#{orgId}
		AND FROM_ID = #{accountId}
		<if test="beginTime!=''.toString() and beginTime!=null">
			AND SEND_TIME &gt;= #{beginTime}
		</if>
		<if test="endTime!=''.toString() and endTime!=null">
			AND SEND_TIME &lt;=#{endTime}
		</if>
		<if
			test="search !='%%' and search !=''.toString() and search!=null">
			AND CONTEXT LIKE#{search}
		</if>
		<if test="module!= ''.toString() and module!=null ">
			AND MODULE = #{module}
		</if>

	</select>

</mapper>

